Calendar Image Encryption
=========================

Use the `calendar/encrypt-image.ps1` script to turn your raw door images into
JSON blobs that the calendar can decrypt in the browser.

1. Prepare source assets
   - Place 24 images in a folder, one per day, named `1.png`, `2.jpg`, … `24.webp`
     (any image extension works; only one file per number).
   - Create a CSV file with columns `day,password`, for example:
     ```
     day,password
     1,cokolada2024
     2,snehulka
     …
     24,vanocni24
     ```
     Each day must appear exactly once and include a non-empty password.

2. Run the encryption script from the project root (PowerShell):
   ```
   powershell -ExecutionPolicy Bypass -File calendar\encrypt-image.ps1 `
     -ImageFolder private\obrazky `
     -PasswordsCsv private\secret.csv `
     -OutputFolder images `
     -Iterations 100000
   ```
   - `-ImageFolder` points to the folder containing `1.*` … `24.*`.
   - `-PasswordsCsv` is the CSV described above.
   - `-OutputFolder` (default `calendar\images`) receives `{day}.json` files.
   - `-Iterations` controls PBKDF2 strength (higher = slower but more secure).

3. After the command finishes you should see `calendar\images\1.json` … `24.json`.
   These files contain the encrypted image, salt, IV, iterations, and content type.
   Re-run the script whenever you swap an image or change a password.

4. Testing in the browser
   - Serve the project via a local web server (required for `fetch` + Web Crypto):
     `python -m http.server 8080` from the project root, then visit
     `http://localhost:8080/calendar/`.
   - Opening a door now prompts for the password you assigned in the CSV; if the
     password matches, the corresponding encrypted JSON is decrypted and shown.

Troubleshooting
---------------
- 404 for `/calendar/` usually means the HTTP server was started from the wrong
  directory; restart it inside `grafit-games-web`.
- “Nesprávný kód” for the right password often indicates the page was opened via
  `file://` or the wrong JSON file; always use `http://localhost` and rerun the
  script after changing assets or passwords.
